<?php if ($this->leagueData) : ?>

    <?php if ($this->checkUserAccess('default' . Acl::RESOURCE_SEPARATOR . 'user', 'id')) {
        $defaultUserIDUrl = $this->url(
            array('module' => 'default', 'controller' => 'user', 'action' => 'id',
                'userID' => $this->escape($this->leagueData['User']['ID'])), 'defaultUserID'
        );
    } else {
        $defaultUserIDUrl = '#';
    }
    ?>

    <div class="block block-default block-ui-bordered">
        <?php
        echo $this->BlockConfigMenu($this->translate("Лига"))->leagueMenu(
            $this->escape($this->leagueData['ID'])
        );
        ?>
        <div class="block-body">
            <div class="row">
                <div class="col-xs-12 col-sm-12 col-md-8 col-lg-8">
                    <div class="block block-default block-ui-bordered">
                        <div>
                            <table class="table table-striped table-bordered m-b-0">
                                <tbody>
                                <tr>
                                    <td class="text-bold">
                                        <span><?php echo $this->translate('Название'); ?></span>
                                    </td>
                                    <td>
                                        <span><?php echo $this->escape($this->leagueData['Name']); ?></span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="text-bold">
                                        <span><?php echo $this->translate('Администратор'); ?></span>
                                    </td>
                                    <td>
                                        <span>
                                            <a target="_blank" href="<?php echo $defaultUserIDUrl; ?>">
                                                <?php echo $this->escape($this->leagueData['User']['NickName']); ?>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="text-bold">
                                        <span><?php echo $this->translate('Описание'); ?></span>
                                    </td>
                                    <td>
                                        <span><?php echo $this->RenderContentTypeText($this->leagueData['Description'], 'full_html'); ?></span>
                                    </td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="col-xs-12 col-sm-12 col-md-4 col-lg-4">
                    <div class="text-center">
                        <?php if ($this->escape($this->leagueData['ImageLogoUrl'])) { ?>
                            <div class="m-b-15 center-block text-center">
                                <a href="#" data-toggle="modal"
                                   data-target=".league-<?php print $this->leagueData['ID']; ?>"
                                   title="<?php echo $this->escape($this->leagueData['Name']); ?>"
                                   class="">
                                    <img class="img-thumbnail img-responsive"
                                         src="<?php echo $this->escape(
                                             $this->leagueData['ImageLogoUrl']
                                         ); ?>"/>
                                </a>
                                <?php echo $this->modal(
                                    array(
                                        'title'   => $this->leagueData['Name'],
                                        'class'   => 'league-' . $this->leagueData['ID'],
                                        'content' =>
                                            '<img src="' . $this->escape($this->leagueData['ImageLogoUrl'])
                                            . '" class="img-responsive img-rounded center-block" alt="">'
                                    )
                                ); ?>
                            </div>
                        <?php } ?>
                    </div>
                </div>
            </div>
        </div>
        <div class="block-footer clearfix">
            <div class="pull-left m-r-15 tooltip-field" data-title="<?php echo $this->translate('Тип контента'); ?>"
                 data-placement="bottom">
                <i class="fa fa-filter fa-lg"></i>
                <?php echo $this->translate('Лига'); ?>
            </div>
            <div class="pull-right m-r-15 tooltip-field" data-title="<?php echo $this->translate('Дата создания'); ?>"
                 data-placement="bottom">
                <i class="fa fa-calendar fa-lg"></i>
                <?php echo $this->escape($this->leagueData['DateCreate']); ?>
            </div>
        </div>
    </div>

    <!-- Championship start -->
    <?php if ($this->championships_data) : ?>
        <div class="section-title m-t-15 m-b-15"><?php echo $this->translate('Чемпионаты лиги') ?></div>
        <?php foreach ($this->championships_data as $championship): ?>
            <div class="row">
                <div class="col-md-12 col-lg-12">
                    <div class="panel panel-default panel-inverse block">
                        <?php
                        echo $this->BlockConfigMenu($this->translate("Чемпионат"))->championshipMenu($this->escape($championship['league_id']), $this->escape($championship['id']));
                        ?>

                        <?php
                        $championshipIdAllUrl = $this->url(array('module' => 'default', 'controller' => 'championship', 'action' => 'id', 'league_id' => $this->leagueData['ID'], 'championship_id' => $this->escape($championship->id)), 'defaultChampionshipId', true);
                        ?>
                        <div class="panel-heading">
                            <h3 class="panel-title">
                                <i class="fa fa-trophy"></i>
                                <a href="<?php echo $championshipIdAllUrl; ?>"><?php echo $this->escape($championship['name']); ?></a>
                            </h3>
                        </div>
                        <div class="panel-body">
                            <?php if ($this->escape($championship['url_logo']) != '') { ?>
                                <div
                                    class="championship_all_logo_wrapper_200_200 img-wrapper-200-200 pull-left overflow-hide m-r-5">
                                    <img class="img-thumbnail img-responsive"
                                         src="<?php echo $this->baseUrl($this->escape($championship['url_logo'])); ?>">
                                </div>
                            <?php } ?>
                            <div class="championship_description">
                                <?php
                                if ($championship['description']) {
                                    echo $this->RenderContentTypeText($championship['description'], 'bbcode');
                                }
                                ?>
                            </div>
                            <div class="pull-right m-t-10">
                                <a href="<?php echo $this->url(array('module' => 'default', 'controller' => 'championship', 'action' => 'ds', 'league_id' => $this->leagueData['ID'], 'championship_id' => $this->escape($championship['id'])), 'defaultChampionshipAction', true); ?>"
                                   class="btn btn-sm btn-success"
                                   title="<?php echo $this->translate('Личный зачет') ?>"><?php echo $this->translate('ЛЗ') ?></a>
                                <a href="<?php echo $this->url(array('module' => 'default', 'controller' => 'championship', 'action' => 'ts', 'league_id' => $this->leagueData['ID'], 'championship_id' => $this->escape($championship['id'])), 'defaultChampionshipAction', true); ?>"
                                   class="btn btn-sm btn-warning"
                                   title="<?php echo $this->translate('Командный зачет') ?>"><?php echo $this->translate('КЗ') ?></a>
                                <a href="<?php echo $this->url(array('module' => 'default', 'controller' => 'championship', 'action' => 'drivers', 'league_id' => $this->leagueData['ID'], 'championship_id' => $this->escape($championship['id'])), 'defaultChampionshipAction', true); ?>"
                                   class="btn btn-sm btn-info"
                                   title="<?php echo $this->translate('Командный зачет') ?>"><?php echo $this->translate('Гонщики') ?></a>
                                <a href="<?php echo $this->url(array('module' => 'default', 'controller' => 'post', 'action' => 'id', 'postID' => $this->escape($championship->rule_id)), 'defaultPostID', true); ?>"
                                   target="_blank" class="btn btn-sm btn-danger post_more"
                                   title="<?php echo $this->translate('Регламент чемпионата') ?>"><?php echo $this->translate('Регламент') ?></a>
                                <a href="<?php echo $championshipIdAllUrl; ?>" class="btn btn-sm btn-primary post_more"
                                   title="<?php echo $this->translate('Детальная информация о чемпионате') ?>"><?php echo $this->translate('Подробнее...') ?></a>
                            </div>
                        </div>
                        <div class="panel-footer">
                            <small>
                                <div class="pull-left m-r-10">
                                    <span class="text-bold font-color-black"><i
                                            class="fa fa-filter font-color-gray"></i> <?php echo $this->translate('Категория контента') ?>
                                        : </span>
                                    <?php echo $this->translate('Чемпионат'); ?>
                                </div>
                                <div class="pull-left m-r-10">
                                    <span class="text-bold font-color-black"><?php echo $this->translate('Создан') ?>
                                        : </span>
                                    <?php echo $this->escape($championship['date_create']); ?>
                                </div>
                                <div class="pull-left m-r-10">
                                    <span class="text-bold font-color-black"><i
                                            class="fa fa-user font-color-gray"></i> <?php echo $this->translate('Администратор') ?>
                                        : </span>
                                    <a href="<?php echo $this->url(array('module' => 'default', 'controller' => 'user', 'action' => 'id', 'userID' => $this->escape($championship['user_id'])), 'defaultUserID', true); ?>"
                                       target="_blank"><?php echo $this->escape($championship['user_login']); ?></a>
                                </div>
                            </small>
                            <div class="clearfix"></div>
                        </div>
                    </div>
                </div>
            </div>
        <?php endforeach; ?>
        <div class="row">
            <div class="col-md-12 col-lg-12">
                <div class="block-item m-t-15">
                    <div class="pull-right">
                        <?php echo $this->paginationControl($this->championships_data, 'Sliding', 'pagers/default_pagination_tpl.phtml'); ?>
                    </div>
                    <div class="clearfix"></div>
                </div>
            </div>
        </div>
    <?php endif; ?>
    <!-- Championship end -->
<?php endif; ?>